<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <base target="_self">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache,must-ridate">
    <meta http-equiv="expires" content="0">
    <title></title>
    <link rel="stylesheet" type="text/css" href="/static/plugins/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/static/plugins/bootstrap-table/bootstrap-table.css" />
    <script type="text/javascript" src="/static/plugins/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/static/plugins/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/static/plugins/bootstrap-table/bootstrap-table.js"></script>
    <script type="text/javascript" src="/static/plugins/bootstrap-table/bootstrap-table-zh-CN.min.js"></script>
</head>

<style  type="text/css">
    .required {
        color: red;
    }       
</style>

<body>
    <table border="1" bordercolor="#C0C0C0" cellspacing="2" cellpadding="2" style="width: 100%;">
        <tr>
            <td style="width: 12%;">
                <span class="required">*</span>受益方式标识:
            </td>
            <td style="width: 21%;">
                <select id="zytabs" name="zytabs" style="width: 180px;" onchange="javascript:changeInfo('1')">
                    <option value="0">自益</option>
                    <option value="1">他益</option>
                    <option value="3">其他</option>
                </select>
            </td>
            <td style="width: 12%;">
                <span class="required">*</span>信托合同编号:
            </td>
            <td style="width: 21%;">
                <input type="text" id="xthtbh" name="xthtbh" value="" style="width: 180px;">
            </td>
            <td style="width: 12%;">
                <span class="required">*</span>合同介质:
            </td>
            <td style="width: 21%;">
                <input type="checkbox" id="htjz0" name="htjz" value="0" />电子<br>
                <input type="checkbox" id="htjz1" name="htjz" value="1" />纸质
            </td>
        </tr>
        <tr>
            <td>
                <span class="required">*</span>委托人全称:
            </td>
            <td>
                <input type="text" id="wtrqc" name="wtrqc" value="" style="width: 180px;">
            </td>
            <td>
                <span class="required">*</span>委托人类型:
            </td>
            <td>
                <select id="wtrlx" name="wtrlx" style="width: 180px;">
                    <option value="0">金融机构</option>
                    <option value="1">金融产品</option>
                    <option value="2">自然人</option>
                    <option value="3">其他机构</option>
                </select>
            </td>
            <td>
                <span class="required">*</span>委托人类型详情:
            </td>
            <td>
                <select id="lxxq_wtr" name="lxxq_wtr" style="width: 180px;">
                    <option value="M00">商业银行及授权分行</option>
                    <option value="M01">政策性银行及其授权分行</option>
                    <option value="M02">企业集团财务公司</option>
                    <option value="M03">金融租赁公司</option>
                    <option value="M04">汽车金融公司</option>
                    <option value="M05">消费金融公司</option>
                    <option value="M06">农村信用社</option>
                    <option value="M07">城市信用社</option>
                    <option value="M08">信托公司及其子公司</option>
                    <option value="M09">基金管理公司及其子公司</option>
                    <option value="M10">证券公司及其子公司</option>
                    <option value="M11">保险公司及保险资产管理公司</option>
                    <option value="M12">期货公司及其子公司</option>
                    <option value="M13">外资金融机构</option>
                    <option value="M14">金融资产管理公司</option>
                    <option value="M15">其他金融机构</option>
                    <option value="N00">银行理财产品</option>
                    <option value="N01">信托产品</option>
                    <option value="N02">保险产品</option>
                    <option value="N03">基金产品</option>
                    <option value="N04">证券公司资管产品</option>
                    <option value="N05">QDII 产品</option>
                    <option value="N06">社保基金</option>
                    <option value="N07">企业年金</option>
                    <option value="N08">慈善基金</option>
                    <option value="N09">私募投资基金</option>
                    <option value="N10">其他金融产品</option>
                    <option value="P00">其他法人机构</option>
                    <option value="P01">政府部门</option>
                    <option value="P02">合伙企业</option>
                    <option value="P03">公益机构</option>
                    <option value="P04">其他非法人机构</option>
                    <option value="Q00">自然人</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <span class="required">*</span>委托人证件类型:
            </td>
            <td>
                <select id="wtrzjlx" name="wtrzjlx" style="width: 180px;">
                    <option value="00">身份证</option>
                    <option value="01">临时身份证</option>
                    <option value="02">户口簿</option>
                    <option value="03">护照</option>
                    <option value="04">军官证</option>
                    <option value="05">士兵证</option>
                    <option value="06">警官证</option>
                    <option value="07">港澳居民来往内地通行证</option>
                    <option value="08">台湾居民来往大陆通行证</option>
                    <option value="09">外国人居留证</option>
                    <option value="10">组织机构代码</option>
                    <option value="11">社会信用代码</option>
                    <option value="12">营业执照</option>
                    <option value="13">产品登记号</option>
                    <option value="14">备案文件</option>
                    <option value="15">许可文件</option>
                    <option value="16">确认函</option>
                    <option value="18">主管部门批文或证明</option>
                    <option value="19">社团法人登记证书</option>
                    <option value="20">事业法人登记证书</option>
                    <option value="21">机关法人成立批文</option>
                    <option value="22">港澳居民居住证</option>
                    <option value="23">台湾居民居住证</option>
                    <option value="99">其他</option>
                </select>
            </td>
            <td>
                <span class="required">*</span>委托人证件号码 (产品登记号/备案号）:
            </td>
            <td>
                <input type="text" id="wtrzjhm" name="wtrzjhm" value="" style="width: 180px;">
            </td>
            <td>
                <span class="required">*</span>合同初始金额:
            </td>
            <td>
                <input type="number" id="htcszje" name="htcszje" value="" style="width: 180px;">
            </td>
        </tr>
        <tr>
            <td>
                <span class="required">*</span>合同初始份额:
            </td>
            <td>
                <input type="number" id="htcszfe" name="htcszfe" value="" style="width: 180px;">
            </td>
            <td>
                <span class="required">*</span>信托财产性质（交付资产类型）:
            </td>
            <td>
                <select id="xtccxz" name="xtccxz" style="width: 180px;" onchange="javascript:changeInfo('2')">
                    <option value="0">资金</option>
                    <option value="1">财产权</option>
                    <option value="2">混合</option>
                </select>
            </td>
            <td>
                资金结算币种:
            </td>
            <td>
                <select id="zjjsbz" name="zjjsbz" style="width: 180px;">
                    <option value=""></option>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                初始委托资金金额:
            </td>
            <td>
                <input type="number" id="wtzjje" name="wtzjje" value="" style="width: 180px;">
            </td>
            <td>
                初始委托财产对应金额:
            </td>
            <td>
                <input type="number" id="wtccdyje" name="wtccdyje" value="" style="width: 180px;">
            </td>
            <td>
                初始委托财产类型:
            </td>
            <td>
                <select id="wtcccclx" name="wtcccclx" style="width: 180px;">
					<option value=""></option>
                    <option value="0">不动产</option>
                    <option value="1">动产</option>
                    <option value="2">股权</option>
                    <option value="3">债权</option>
                    <option value="4">有价证券</option>
                    <option value="5">收（受）益权</option>
                    <option value="7">专利权</option>
                    <option value="8">其他权利</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>受益人序号:</td>
            <td>
                <input type="number" id="syrxh" name="syrxh" value="" style="width: 180px;">
            </td>
            <td>受益人全称:</td>
            <td>
                <input type="text" id="syrmc" name="syrmc" value="" style="width: 180px;">
            </td>
            <td>受益人类型:</td>
            <td>
                <select id="syrlx" name="syrlx" style="width: 180px;">
					<option value=""></option>
                    <option value="0">金融机构</option>
                    <option value="1">金融产品</option>
                    <option value="2">自然人</option>
                    <option value="3">其他机构</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>受益人类型详情:</td>
            <td>
                <select id="lxxq_syr" name="lxxq_syr" style="width: 180px;">
					<option value=""></option>
                    <option value="M00">商业银行及授权分行</option>
                    <option value="M01">政策性银行及其授权分行</option>
                    <option value="M02">企业集团财务公司</option>
                    <option value="M03">金融租赁公司</option>
                    <option value="M04">汽车金融公司</option>
                    <option value="M05">消费金融公司</option>
                    <option value="M06">农村信用社</option>
                    <option value="M07">城市信用社</option>
                    <option value="M08">信托公司及其子公司</option>
                    <option value="M09">基金管理公司及其子公司</option>
                    <option value="M10">证券公司及其子公司</option>
                    <option value="M11">保险公司及保险资产管理公司</option>
                    <option value="M12">期货公司及其子公司</option>
                    <option value="M13">外资金融机构</option>
                    <option value="M14">金融资产管理公司</option>
                    <option value="M15">其他金融机构</option>
                    <option value="N00">银行理财产品</option>
                    <option value="N01">信托产品</option>
                    <option value="N02">保险产品</option>
                    <option value="N03">基金产品</option>
                    <option value="N04">证券公司资管产品</option>
                    <option value="N05">QDII产品</option>
                    <option value="N06">社保基金</option>
                    <option value="N07">企业年金</option>
                    <option value="N08">慈善基金</option>
                    <option value="N09">私募投资基金</option>
                    <option value="N10">其他金融产品</option>
                    <option value="P00">其他法人机构</option>
                    <option value="P01">政府部门</option>
                    <option value="P02">合伙企业</option>
                    <option value="P03">公益机构</option>
                    <option value="P04">其他非法人机构</option>
                    <option value="Q00">自然人</option>
                </select>
            </td>
            <td>受益人证件类型:</td>
            <td>
                <select id="syrzjlx" name="syrzjlx" style="width: 180px;">
					<option value=""></option>
                    <option value="00">身份证</option>
                    <option value="01">临时身份证</option>
                    <option value="02">户口簿</option>
                    <option value="03">护照</option>
                    <option value="04">军官证</option>
                    <option value="05">士兵证</option>
                    <option value="06">警官证</option>
                    <option value="07">港澳居民来往内地通行证</option>
                    <option value="08">台湾居民来往大陆通行证</option>
                    <option value="09">外国人居留证</option>
                    <option value="10">组织机构代码</option>
                    <option value="11">社会信用代码</option>
                    <option value="12">营业执照</option>
                    <option value="13">产品登记号</option>
                    <option value="14">备案文件</option>
                    <option value="15">许可文件</option>
                    <option value="16">确认函</option>
                    <option value="18">主管部门批文或证明</option>
                    <option value="19">社团法人登记证书</option>
                    <option value="20">事业法人登记证书</option>
                    <option value="21">机关法人成立批文</option>
                    <option value="22">港澳居民居住证</option>
                    <option value="23">台湾居民居住证</option>
                    <option value="99">其他</option>
                </select>
            </td>
            <td>受益人证件号码 (产品登记号/备案号）:</td>
            <td>
                <input type="text" id="syrzjhm" name="syrzjhm" value="" style="width: 180px;">
            </td>
        </tr>
        <tr>
            <td>
                <span class="required">*</span>受益权代码 :
            </td>
            <td>
                <input type="text" id="syqdm" name="syqdm" value="" style="width: 180px;">
            </td>
            <td>
                是否在中国信登开设信托受益权账户标识:
            </td>
            <td>
                <select id="sfkssyqzh_syr" name="sfkssyqzh_syr" style="width: 180px;">
                    <option value=""></option>
                    <option value="1">是</option>
                    <option value="0">否</option>
                </select>
            </td>
            <td>
                信托受益权账户编码:
            </td>
            <td>
                <input type="text" id="syqzhbm_syr" name="syqzhbm_syr" value="" style="width: 180px;">
            </td>
        </tr>
        <tr>
            <td>
                <span class="required">*</span>受益权初始份额:
            </td>
            <td>
                <input type="number" id="syqcsfe" name="syqcsfe" value="" style="width: 180px;">
            </td>
            <td>
                <span class="required">*</span>受益权初始金额:
            </td>
            <td>
                <input type="number" id="syqcsje" name="syqcsje" value="" style="width: 180px;">
            </td>
            <td>
                <span class="required">*</span>受益权起始日:
            </td>
            <td>
                <input type="date" id="syqqsr" name="syqqsr" value="" style="width: 180px;">
            </td>
        </tr>
        <tr>
            <td>
                <span class="required">*</span>受益权计划到期日:
            </td>
            <td>
                <input type="date" id="syqjhdqr" name="syqjhdqr" value="" style="width: 180px;">
            </td>
            <td>
                受益人优先劣后标识:
            </td>
            <td colspan="3">
                <select id="syryxlhbs" name="syryxlhbs" style="width: 180px;">
                    <option value=""></option>
                    <option value="1">优先</option>
                    <option value="2">中间</option>
                    <option value="3">劣后</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                情况说明:
            </td>
            <td colspan="5">
                <textarea rows="3" id="qksm" name="qksm" style="width:990px;"></textarea>
            </td>
        </tr>
    </table>
    <div style="height: 50px; line-height: 50px; text-align: right;">
        <button type="button" id="btnSave" class="btn btn-danger">保 存</button>&nbsp;&nbsp;
        <button type="button" id="btnReturn" class="btn btn-success">返 回</button>&nbsp;&nbsp;
    </div>
</body>
    
    <script type="text/javascript">
        //初始化数据
        let ydjData = new Object();
        $(function () {
            let id = GetQueryValue('id');
            let uuid = GetQueryValue('uuid');
            let bsid = GetQueryValue('bsid');
            let regitem_id = GetQueryValue('regitem_id');
            let productid = GetQueryValue('productid');
            let productcode = GetQueryValue('productcode');

            //返回合同列表
            $("#btnReturn").click(function() {
                returnContractList(uuid);
            });

            //保存信托合同信息
            $("#btnSave").click(function() {
                saveContractInfo(id, uuid, bsid, regitem_id, productid, productcode);
            });

            //加载信托合同信息
            if (id != 0) {
                loadContractInfo(id);
            } else {
				initSelect("zjjsbz", "Init011", "CNY");
            }
        });
		
		//设置text,textarea和select对应值
		function setFormValue(name,value){
			$('#'+name).val(value);
		}
		
		//设置Radio对应值
		function setRadioValue(name,value){
			if(value==""){
				$("input[name="+name+"]").prop("checked",false);
			}else{
				$("input[name="+name+"][value="+value+"]").attr("checked", true);
			}
		}
		
		//设置Box对应值
		function setBoxValue(name,content){	
			if(content.indexOf('No,')>=0)
			{
				content=content.replace('No,','');
				let returnValue = content.split(",");
				$.each(returnValue, function (index, value) {
					$("#"+name+value).attr("checked",false)
				});
			}else{
				let returnValue = content.split(",");
				$.each(returnValue, function (index, value) {
					$("#"+name+value).attr("checked",true)
				});			
			}
		}
		
		//获取text,textarea和select对应值
		function getFormValue(name){
			let value = $('#'+name).val();
			return value;
		}
		
		//获取Radio对应值
		function getRadioValue(name){
			let value = $("input[name="+name+"]:checked").val();
			return value;
		}
		
		//获取Box对应值
		function getBoxValue(name){
			let value = $("input:checkbox[name="+name+"]:checked");
            let chvalue = [];
            $.each(value, function () {
                chvalue.push($(this).val());
            });
            value = chvalue.join(",");
			return value;
		}
		
		//日期格式化处理
		Date.prototype.Format = function(fmt)  
		{ 
			var o = {  
				"M+" : this.getMonth()+1,         //月份  
				"d+" : this.getDate(),          //日  
				"h+" : this.getHours(),          //小时  
				"m+" : this.getMinutes(),         //分  
				"s+" : this.getSeconds(),         //秒  
				"q+" : Math.floor((this.getMonth()+3)/3), //季度  
				"S" : this.getMilliseconds()       //毫秒  
			};  
			if(/(y+)/.test(fmt))  
				fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length));  
			for(var k in o)  
				if(new RegExp("("+ k +")").test(fmt))  
			fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));  
			return fmt;  
		}

		//字段必输项+内容大小限制校验
        function checkInfo(name,content,flag,type){
			if(type=='text') value = getFormValue(name);
			else if(type=='box') value = getBoxValue(name);
			else if(type=='radio') value = getRadioValue(name);
			else value = getFormValue(name);
			if(flag=="required")
			{
				if(typeof(value)=="undefined" || value==null || value.length==0 || value==''){
					alert("字段["+content+"]为必填项!");
					document.getElementById(name).focus();
					return false;
				}
			}else if(flag=="length"){
				if(!(typeof(value)=="undefined" || value==null || value.length==0 || value=='') && value.length>type){
					alert("字段["+content+"]内容超过最大限制!");
					document.getElementById(name).focus();
					return false;
				}			
			}else if(flag=="number"){
				if(!(typeof(value)=="undefined" || value==null || value.length==0 || value=='')){
					var typeValue=type.split(",");
					if(value.indexOf(".")<0) value=value+'.00';
					var contentValue=value.split(".");
					if(contentValue[0].length > (typeValue[0]-typeValue[1]) || contentValue[1].length > typeValue[1]){
						alert("字段["+content+"]内容超过最大限制!");
						document.getElementById(name).focus();
						return false;
					}					
				}			
			}
			return true;
		}	

		//保存之前逻辑性校验
		function logicCheck(){
			//信托财产性质（交付资产类型）
			var xtccxz=getFormValue('xtccxz');
			var zjjsbz=getFormValue('zjjsbz');
			var wtzjje=getFormValue('wtzjje');
			var wtccdyje=getFormValue('wtccdyje');
			var wtcccclx=getFormValue('wtcccclx');
			if((xtccxz=="0" || xtccxz=="2") && (typeof(zjjsbz)=="undefined" || zjjsbz==null || zjjsbz.length==0  || zjjsbz.length==''))
			{
				alert("当[信托财产性质（交付资产类型）]勾选【资金】或【混合】时,字段[资金结算币种]为必填项!");
				return false;
			}
			if((xtccxz=="0" || xtccxz=="2") && (typeof(wtzjje)=="undefined" || wtzjje==null || wtzjje.length==0  || wtzjje.length==''))
			{
				alert("当[信托财产性质（交付资产类型）]勾选【资金】或【混合】时,字段[初始委托资金金额]为必填项!");
				return false;
			}
			if((xtccxz=="1" || xtccxz=="2") && (typeof(wtccdyje)=="undefined" || wtccdyje==null || wtccdyje.length==0  || wtccdyje.length==''))
			{
				alert("当[信托财产性质]勾选【财产权】或【混合】时,字段[初始委托财产对应金额]为必填项!");
				return false;
			}		
			if((xtccxz=="1" || xtccxz=="2") && (typeof(wtcccclx)=="undefined" || wtcccclx==null || wtcccclx.length==0  || wtcccclx.length==''))
			{
				alert("当[信托财产性质]勾选【财产权】或【混合】时,字段[初始委托财产类型]为必填项!");
				return false;
			}
			if(xtccxz=="1"){
				setFormValue('zjjsbz','');
				setFormValue('wtzjje','');
			}
			if(xtccxz=="0"){
				setFormValue('wtccdyje','');
				setFormValue('wtcccclx','');
			}
			//委托人全称+受益人全称
			var zytabs=getFormValue('zytabs');
			var wtrqc=getFormValue('wtrqc');
			var syrmc=getFormValue('syrmc');		
			if(zytabs=="0" && wtrqc!=syrmc && !(typeof(syrmc)=="undefined" || syrmc==null || syrmc.length==0  || syrmc.length==''))
			{
				alert("[受益方式标识]选择【自益】时,委托人全称必须等于受益人全称!");
				return false;
			}
			if(zytabs=="1" || zytabs=="3")
			{
				if(!(typeof(syrxh)=="undefined" || syrxh==null || syrxh.length==0 || syrxh.length=='')){
					alert("[受益方式标识]选择【他益】或【其他】时,字段[受益人序号]为必填项!");
					return false;
				}
				if(!(typeof(syrmc)=="undefined" || syrmc==null || syrmc.length==0 || syrmc.length=='')){
					alert("[受益方式标识]选择【他益】或【其他】时,字段[受益人全称]为必填项!");
					return false;
				}
				if(!(typeof(syrlx)=="undefined" || syrlx==null || syrlx.length==0 || syrlx.length=='')){
					alert("[受益方式标识]选择【他益】或【其他】时,字段[受益人类型]为必填项!");
					return false;
				}
				if(!(typeof(lxxq_syr)=="undefined" || lxxq_syr==null || lxxq_syr.length==0 || lxxq_syr.length=='')){
					alert("[受益方式标识]选择【他益】或【其他】时,字段[受益人类型详情]为必填项!");
					return false;
				}
				if(!(typeof(syrzjlx)=="undefined" || syrzjlx==null || syrzjlx.length==0 || syrzjlx.length=='')){
					alert("[受益方式标识]选择【他益】或【其他】时,字段[受益人证件类型]为必填项!");
					return false;
				}
				if(!(typeof(syrzjhm)=="undefined" || syrzjhm==null || syrzjhm.length==0 || syrzjhm.length=='')){
					alert("[受益方式标识]选择【他益】或【其他】时,字段[	受益人证件号码 (产品登记号/备案号）]为必填项!");
					return false;
				}				
			}			
			//委托人证件号码+受益人证件号码
			var wtrzjlx=getFormValue('wtrzjlx');
			var syrzjlx=getFormValue('syrzjlx');
			var wtrzjhm=getFormValue('wtrzjhm');
			var syrzjhm=getFormValue('syrzjhm');
			var qksm=getFormValue('qksm');	
			if(zytabs=="1" && wtrzjhm!=syrzjhm)
			{
				alert("[受益方式标识]选择【他益】时,[委托人证件号码]不可以与[受益人证件号码]相同！");
				return false;
			}
			if(wtrzjlx=="11" && wtrzjhm.length!=18)
			{
				alert("[委托人证件类型]选择【社会信用代码】时,[委托人证件号码]位数必须为18位！");
				return false;
			}
			if(wtrzjlx=="12" && (wtrzjhm.length!=15 || wtrzjhm.length!=18))
			{
				alert("[委托人证件类型]选择【营业执照】时,[委托人证件号码]位数必须为15位或18位！");
				return false;
			}
			if(syrzjlx=="11" && syrzjhm.length!=18)
			{
				alert("[受益人证件号码]选择【社会信用代码】时,[受益人证件号码]位数必须为18位！");
				return false;
			}
			if(syrzjlx=="12" && (syrzjhm.length!=15 || syrzjhm.length!=18))
			{
				alert("[受益人证件号码]选择【营业执照】时,[受益人证件号码]位数必须为15位或18位！");
				return false;
			}	
			if((zytabs=="3" || wtrzjlx=='99'|| syrzjlx=='99') && (typeof(qksm)=="undefined" || qksm==null || qksm.length==0  || qksm.length==''))
			{
				alert("[受益方式标识]选择【其他】或[委托人证件类型]选择【其他】或[受益人证件类型]选择【其他】时,字段[情况说明]为必填项！");
				return false;
			}		
			//受益权起始日+受益权计划到期日
			var syqqsr=getFormValue('syqqsr');
			var syqjhdqr=getFormValue('syqjhdqr');
			var today = new Date().Format("yyyy-MM-dd");
			if(syqqsr > today){
				//alert("[受益权起始日]必须小于等于今天!");
				//return false;
			}		
			if(syqjhdqr < today){
				//alert("[受益权计划到期日]必须大于今天!");
				//return false;
			}	
			return true;
		}	

		//保存之前必输项校验
		function requiredCheck(){
			if(!checkInfo('zytabs','受益方式标识','required','text')) return false;
			if(!checkInfo('xthtbh','信托合同编号','required','text')) return false;
			if(!checkInfo('htjz','合同介质','required','box')) return false;
			if(!checkInfo('wtrqc','委托人全称','required','text')) return false;
			if(!checkInfo('wtrlx','委托人类型','required','text')) return false;
			if(!checkInfo('lxxq_wtr','委托人类型详情','required','text')) return false;
			if(!checkInfo('wtrzjlx','委托人证件类型','required','text')) return false;	
			if(!checkInfo('wtrzjhm','委托人证件号码 (产品登记号/备案号）','required','text')) return false;
			if(!checkInfo('htcszje','合同初始金额','required','text')) return false;
			if(!checkInfo('htcszfe','合同初始份额','required','text')) return false;
			if(!checkInfo('xtccxz','信托财产性质（交付资产类型）','required','text')) return false;
			if(!checkInfo('syqdm','受益权代码','required','text')) return false;
			if(!checkInfo('syqcsfe','受益权初始份额','required','text')) return false;
			if(!checkInfo('syqcsje','受益权初始金额','required','text')) return false;
			if(!checkInfo('syqqsr','受益权起始日','required','text')) return false;			
			if(!checkInfo('syqjhdqr','受益权计划到期日','required','text')) return false;
			
			return true;
		}				
		
		//保存之前内容大小限制校验
		function sizeCheck(){		
			if(!checkInfo('xthtbh','信托合同编号','length','100')) return false;
			if(!checkInfo('wtrqc','委托人全称','length','100')) return false;
			if(!checkInfo('wtrzjhm','委托人证件号码 (产品登记号/备案号）','length','50')) return false;
			if(!checkInfo('htcszje','合同初始金额','number','16,2')) return false;
			if(!checkInfo('htcszfe','合同初始份额','number','16,2')) return false;
			if(!checkInfo('syrxh','受益人序号','length','10')) return false;
			if(!checkInfo('syrmc','受益人全称','length','50')) return false;
			if(!checkInfo('cpqc','受益人证件号码 (产品登记号/备案号）','length','50')) return false;
			if(!checkInfo('syqdm','受益权代码','length','50')) return false;
			if(!checkInfo('gscpbh','信托受益权账户编码','length','20')) return false;
			if(!checkInfo('syqcsfe','受益权初始份额','number','16,2')) return false;
			if(!checkInfo('syqcsje','受益权初始金额','number','16,2')) return false;
			if(!checkInfo('syqqsr','受益权起始日','length','10')) return false;
			if(!checkInfo('syqjhdqr','受益权计划到期日','length','10')) return false;
			
			return true;
		}			

        //加载信托合同信息
        function loadContractInfo(id) {
            jQuery.ajax({
                //请求方式
                type: "POST",
                //请求地址
                url: "/node/find_app_dfs_zxd_csxtht_by_id",
                //数据，json对象
                data: {"id": id},
                //请求成功
                success: function (data) {
                    data = data[0];
                    $("#zytabs").val(data.zytabs);
                    $("#xthtbh").val(data.xthtbh);
                    let htjzs = data.htjz.split(",");
                    $.each(htjzs, function (index, value) {
                        if (value != "")
                            $("#htjz"+value).attr("checked", "checked");
                    });
                    $("#wtrqc").val(data.wtrqc);
                    $("#wtrlx").val(data.wtrlx);
                    $("#lxxq_wtr").val(data.lxxq_wtr);
                    $("#wtrzjlx").val(data.wtrzjlx);
                    $("#wtrzjhm").val(data.wtrzjhm);
                    $("#htcszje").val(data.htcszje);
                    $("#htcszfe").val(data.htcszfe);
                    $("#xtccxz").val(data.xtccxz);
                    initSelect("zjjsbz", "Init011", data.zjjsbz);
                    $("#wtzjje").val(data.wtzjje);
                    $("#wtccdyje").val(data.wtccdyje);
                    $("#wtcccclx").val(data.wtcccclx);
                    $("#syrxh").val(data.syrxh);
                    $("#syrmc").val(data.syrmc);
                    $("#syrlx").val(data.syrlx);
                    $("#lxxq_syr").val(data.lxxq_syr);
                    $("#syrzjlx").val(data.syrzjlx);
                    $("#syrzjhm").val(data.syrzjhm);
                    $("#syqdm").val(data.syqdm);
					$("#sfkssyqzh_syr").val(data.sfkssyqzh_syr);
                    $("#syqzhbm_syr").val(data.syqzhbm_syr);
                    $("#syqcsfe").val(data.syqcsfe);
                    $("#syqcsje").val(data.syqcsje);
                    $("#syqqsr").val(data.syqqsr);
                    $("#syqjhdqr").val(data.syqjhdqr);
                    $("#syryxlhbs").val(data.syryxlhbs);
                    $("#qksm").val(data.qksm);
					changeInfo(1);
					changeInfo(2);
                },
                //请求失败，包含具体的错误信息
                error: function (e) {
                    alert("信托合同信息加载失败！");
                }
            });
        }

        //保存信托合同信息
        function saveContractInfo(id, uuid, bsid, regitem_id, productid, productcode) {
			//保存之前必输项校验
			if(!requiredCheck()){
				return false;	
			}		
			//监管报送逻辑校验
			if(!logicCheck()){
				return false;	
			}
			//监管报送内容大小限制校验
			if(!sizeCheck()){
				return false;	
			}		
		
            let tjdNos = new Object();
            tjdNos.id = id;
            tjdNos.uuid = uuid;
            tjdNos.bsid = bsid;
            tjdNos.regitem_id = regitem_id;
            tjdNos.productid = productid;
            tjdNos.productcode = productcode;
            tjdNos.zytabs=$("#zytabs").val();
            tjdNos.xthtbh=$("#xthtbh").val();
            let htjzs = $("input:checkbox[name='htjz']:checked");
            let chhtjzs = [];
            $.each(htjzs, function () {
                chhtjzs.push($(this).val());
            });
            tjdNos.htjz = chhtjzs.join(",");
            tjdNos.wtrqc=$("#wtrqc").val();
            tjdNos.wtrlx=$("#wtrlx").val();
            tjdNos.lxxq_wtr=$("#lxxq_wtr").val();
            tjdNos.wtrzjlx=$("#wtrzjlx").val();
            tjdNos.wtrzjhm=$("#wtrzjhm").val();
            tjdNos.htcszje=$("#htcszje").val();
            tjdNos.htcszfe=$("#htcszfe").val();
            tjdNos.xtccxz=$("#xtccxz").val();
            tjdNos.zjjsbz=$("#zjjsbz").val();
            tjdNos.wtzjje=$("#wtzjje").val();
            tjdNos.wtccdyje=$("#wtccdyje").val();
            tjdNos.wtcccclx=$("#wtcccclx").val();
            tjdNos.syrxh=$("#syrxh").val();
            tjdNos.syrmc=$("#syrmc").val();
            tjdNos.syrlx=$("#syrlx").val();
            tjdNos.lxxq_syr=$("#lxxq_syr").val();
            tjdNos.syrzjlx=$("#syrzjlx").val();
            tjdNos.syrzjhm=$("#syrzjhm").val();
            tjdNos.syqdm=$("#syqdm").val();
			tjdNos.sfkssyqzh_syr=$("#sfkssyqzh_syr").val();
            tjdNos.syqzhbm_syr=$("#syqzhbm_syr").val();
            tjdNos.syqcsfe=$("#syqcsfe").val();
            tjdNos.syqcsje=$("#syqcsje").val();
            tjdNos.syqqsr=$("#syqqsr").val();
            tjdNos.syqjhdqr=$("#syqjhdqr").val();
            tjdNos.syryxlhbs=$("#syryxlhbs").val();
            tjdNos.qksm=$("#qksm").val();
            jQuery.ajax({
                //请求方式
                type: "POST",
                //请求地址
                url: "/node/insert_app_dfs_zxd_csxtht",
                //数据，json对象
                data: tjdNos,
                //请求成功
                success: function (data) {
                    if (data.code == "1") {
                        returnContractList(uuid);
                        alert("信托合同保存成功！");
                    } else {
                        alert("信托合同保存失败！");
                    }
                },
                //请求失败，包含具体的错误信息
                error: function (e) {
                    alert("数据请求异常！");
                }
            });
        }

        //返回合同列表
        function returnContractList(uuid) {
            $(window.parent.$('#xthtIFrame')).attr('src', "/node/xthtList.html" + '?uuid=' + uuid);
        }

        //初始化数据字典
        function initSelect(id, region_code, val) {
            jQuery.ajax({
                //请求方式
                type: "POST",
                //请求地址
                url: "/node/query_app_dfs_scode_content",
                //数据，json对象
                data: { "region_code": region_code, "item_code": "" },
                success: function (data) {
                    if (data != "" && data.length != 1) {
                        $.each(data, function (index, item) {
                            if (item.ITEM_CODE == val) {
                                $("#" + id).append("<option value='" + item.ITEM_CODE + "' selected>" + item.ITEM_NAME + "</option>");
                            } else {
                                $("#" + id).append("<option value='" + item.ITEM_CODE + "'>" + item.ITEM_NAME + "</option>");
                            }
                        });
                    }
                }
            });
        }
    
        //获取GET参数
        function GetQueryValue(queryName) {
            var query = decodeURI(window.location.search.substring(1));
            var vars = query.split("&");
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split("=");
                if (pair[0] == queryName) { return pair[1]; }
            }
            return null;
        }
        //选择发生值变化
        function changeInfo(no) {
            if(no=="1"){
				var zytabs=getFormValue('zytabs');
				if(zytabs=="0")
				{	
					$('#syrxh').attr("disabled",true);
					$('#syrmc').attr("disabled",true);
					$('#syrlx').attr("disabled",true);
					$('#lxxq_syr').attr("disabled",true);
					$('#syrzjlx').attr("disabled",true);
					$('#syrzjhm').attr("disabled",true);
					setFormValue('syrxh','');
					setFormValue('syrmc','');	
					setFormValue('syrlx','');	
					setFormValue('lxxq_syr','');	
					setFormValue('syrzjlx','');	
					setFormValue('syrzjhm','');	
				}else{
					$('#syrxh').attr("disabled",false);
					$('#syrmc').attr("disabled",false);
					$('#syrlx').attr("disabled",false);
					$('#lxxq_syr').attr("disabled",false);
					$('#syrzjlx').attr("disabled",false);
					$('#syrzjhm').attr("disabled",false);				
				}
			}else if(no=="2"){
				var xtccxz=getFormValue('xtccxz');
				if(xtccxz=="0")
				{	
					$('#wtccdyje').attr("disabled",true);
					$('#wtcccclx').attr("disabled",true);
					$('#zjjsbz').attr("disabled",false);
					$('#wtzjje').attr("disabled",false);					
					setFormValue('wtccdyje','');
					setFormValue('wtcccclx','');					
				}else if(xtccxz=="1"){
					$('#zjjsbz').attr("disabled",true);
					$('#wtzjje').attr("disabled",true);
					$('#wtccdyje').attr("disabled",false);
					$('#wtcccclx').attr("disabled",false);					
					setFormValue('zjjsbz','');
					setFormValue('wtzjje','');			
				}else{
					$('#zjjsbz').attr("disabled",false);
					$('#wtzjje').attr("disabled",false);
					$('#wtccdyje').attr("disabled",false);
					$('#wtcccclx').attr("disabled",false);				
				}
			}
        }		
    </script>
</html>